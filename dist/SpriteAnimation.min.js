!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):i.SpriteAnimation=t()}(this,function(){"use strict";function i(){for(var t=arguments.length,n=Array(t),s=0;s<t;s++)n[s]=arguments[s];if(!(this instanceof i))return new i(n);console.log("options1",n),this.init(n)}var t={isObject:function(i){return"[object Object]"===Object.prototype.toString.call(i)},isString:function(i){return"string"==typeof i},isNumber:function(i){return"number"==typeof i&&isFinite(i)},isPx:function(i){return this.isString(i)&&i.trim().endsWith("px")},isSecond:function(i){return this.isString(i)&&i.trim().endsWith("s")},$:function(i){return document.querySelector?document.querySelector(i):i.indexOf("#")>-1?document.getElementById(i.replace("#","")):i.indexOf(".")>-1?document.getElementsByClassName(i.replace(".",""))[0]:document.getElementsByTagName(i)[0]},getRealVal:function(i){return parseInt(i)}};return i.prototype={init:function(i){return i&&i[0]&&t.isObject(i[1])?t.$(i[0])?(this.ele=t.$(i[0]),this.ele.scrollWidth&&this.ele.scrollHeight?(this.defaultConfigOptions={image:"",width:0,height:0,padding:0,frames:0,duration:"2s",loop:!0,imageProcess:function(){},imageLoaded:function(){},animationCompleted:function(){},animationFrame:function(){}},this.configOptions=Object.assign(this.defaultConfigOptions,i[1]),void(t.isString(this.configOptions.image)?this.initCanvas().loadImage(this.configOptions.image):this.initCanvas().loadImages(this.configOptions.image))):new Error("this ele argument is wrong")):new Error("can not get this Dom"):new Error("this argument is wrong")},initCanvas:function(){return this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.ele.scrollWidth,this.canvas.height=this.ele.scrollHeight,this.ele.appendChild(this.canvas),this},loadImage:function(i){var t=this;this.sourceImage=new Image,this.sourceImage.setAttribute("crossOrigin","anonymous"),this.sourceImage.onload=function(){t.sourceImageW=t.sourceImage.naturalWidth,t.sourceImageH=t.sourceImage.naturalHeight,t.configOptions.imageLoaded&&t.configOptions.imageLoaded(),t.getRowCol()},this.sourceImage.src=i},loadImages:function(i){var n=this;this.sourceImages=[];var s=0;0===i.length&&setTimeout(function(){return n.configOptions.imageLoaded&&n.configOptions.imageLoaded()},0),i.map(function(e,o){n.sourceImages[o]=new Image,n.sourceImages[o].setAttribute("crossOrigin","anonymous"),n.sourceImages[o].onload=function(){s++,n.configOptions.imageProcess&&n.configOptions.imageProcess((s/i.length).toFixed(2)),s===i.length&&(n.configOptions.imageLoaded&&n.configOptions.imageLoaded(),n.configOptions.frames=i.length,n.interval=1e3*t.getRealVal(n.configOptions.duration)/n.configOptions.frames,n.thenTime=Date.now(),n.framesIndex=0,n.computeTime())},n.sourceImages[o].src=e})},getRowCol:function(){if(this.rowCount=Math.floor((this.sourceImageW+this.configOptions.padding)/(this.configOptions.width+this.configOptions.padding)),this.colCount=Math.floor((this.sourceImageH+this.configOptions.padding)/(this.configOptions.height+this.configOptions.padding)),this.rowCount*this.colCount<this.configOptions.frames)return new Error("this sprite wrong");this.rowIndex=1,this.colIndex=1,this.framesIndex=1,this.interval=1e3*t.getRealVal(this.configOptions.duration)/this.configOptions.frames,this.thenTime=Date.now(),this.computeTime()},computeTime:function(){var i=this;this.nowTime=Date.now(),this.delta=this.nowTime-this.thenTime,this.RAF=window.requestAnimationFrame(function(){return i.computeTime()}),this.delta>this.interval&&(this.thenTime=this.nowTime-this.delta%this.interval,this.drawImage())},drawImage:function(){t.isString(this.configOptions.image)?(this.sx=(this.rowIndex-1)*(this.configOptions.width+this.configOptions.padding),this.sy=(this.colIndex-1)*(this.configOptions.height+this.configOptions.padding),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.sourceImage,this.sx,this.sy,this.configOptions.width,this.configOptions.height,0,0,this.canvas.width,this.canvas.height),(this.rowIndex-1)*(this.configOptions.width+this.configOptions.padding)<this.sourceImageW&&(this.rowIndex+=1),this.rowIndex>this.rowCount&&(this.rowIndex=1,this.colIndex+=1),this.configOptions.animationFrame&&this.configOptions.animationFrame(this.framesIndex),this.framesIndex++,this.framesIndex>this.configOptions.frames&&this.configOptions.loop?(this.rowIndex=1,this.colIndex=1,this.framesIndex=1):this.framesIndex>this.configOptions.frames&&!this.configOptions.loop&&(this.rowIndex=this.rowCount*this.colCount>this.configOptions.frames?this.configOptions.frames%this.rowCount==0?1:this.configOptions.frames%this.rowCount:this.rowCount,this.colIndex=this.rowCount*this.colCount>this.configOptions.frames?Math.floor(this.configOptions.frames/this.rowCount)+1:this.colCount,this.sx=(this.rowIndex-1)*(this.configOptions.width+this.configOptions.padding),this.sy=(this.colIndex-1)*(this.configOptions.height+this.configOptions.padding),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.sourceImage,this.sx,this.sy,this.configOptions.width,this.configOptions.height,0,0,this.canvas.width,this.canvas.height),window.cancelAnimationFrame(this.RAF),this.configOptions.animationCompleted&&this.configOptions.animationCompleted())):(this.sx=0,this.sy=0,this.sw=this.sourceImages[this.framesIndex].naturalWidth,this.sh=this.sourceImages[this.framesIndex].naturalHeight,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.sourceImages[this.framesIndex],this.sx,this.sy,this.sw,this.sh,0,0,this.canvas.width,this.canvas.height),this.configOptions.animationFrame&&this.configOptions.animationFrame(this.framesIndex+1),this.framesIndex++,this.framesIndex===this.configOptions.frames&&this.configOptions.loop?this.framesIndex=0:this.framesIndex!==this.configOptions.frames||this.configOptions.loop||(window.cancelAnimationFrame(this.RAF),this.configOptions.animationCompleted&&this.configOptions.animationCompleted()))}},window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(i){window.setTimeout(i,1e3/60)}}(),window.cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout,i});
//# sourceMappingURL=SpriteAnimation.min.js.map
